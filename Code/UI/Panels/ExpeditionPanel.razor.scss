ExpeditionPanel {
	flex: 1;
	width: 100%;
	height: 100%;
}

.expedition-panel {
	display: flex;
	flex-direction: column;
	width: 100%;
	height: 100%;
	gap: 10px;
	overflow: hidden;
	position: relative;
	padding: 20px 12px 0px 12px;

	// Background image
	background-image: url(ui/menus/expedition_background.png);
	background-size: cover;
	background-position: center;

	// Dark overlay for readability
	&::before {
		content: "";
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background-image: linear-gradient(180deg, rgba(8, 8, 18, 0.85), rgba(15, 12, 30, 0.92));
		z-index: 0;
		pointer-events: none;
	}
}

// Ensure content is above overlay (exclude BattleView, popup overlays, and controls which need higher z-index)
.expedition-panel > *:not(BattleView):not(.monsters-popup-overlay):not(.negotiation-overlay):not(.expedition-controls) {
	position: relative;
	z-index: 1;
}

// ============================================
// HEADER
// ============================================
.panel-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 4px;
	flex-shrink: 0;
	position: relative;
	z-index: 2;
	animation: headerSlideIn 0.3s ease-out;
}

.header-text {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.panel-title {
	font-size: 28px;
	font-weight: 700;
	color: #ffffff;
}

.panel-subtitle {
	font-size: 14px;
	color: rgba(255, 255, 255, 0.5);
}

// Team view wrapper with transition
.team-view {
	display: flex;
	flex-direction: column;
	flex: 1;
	gap: 20px;
	min-height: 0;
	position: relative;
	z-index: 1;
	animation: slideInFromRight 0.3s ease-out;

	&.transitioning-out {
		animation: slideOutToLeft 0.3s ease-in forwards;
	}

	&.transitioning-back {
		animation: slideOutToRight 0.25s ease-in forwards;
	}
}

@keyframes slideInFromRight {
	from {
		opacity: 0;
		transform: translateX(40px);
	}
	to {
		opacity: 1;
		transform: translateX(0);
	}
}

@keyframes slideOutToLeft {
	from {
		opacity: 1;
		transform: translateX(0);
	}
	to {
		opacity: 0;
		transform: translateX(-40px);
	}
}

@keyframes slideOutToRight {
	from {
		opacity: 1;
		transform: translateX(0);
	}
	to {
		opacity: 0;
		transform: translateX(40px);
	}
}

// Team selection header (matches MonsterRosterPanel style)
.roster-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	flex-shrink: 0;
	position: relative;
	z-index: 2;
}

.header-left {
	display: flex;
	align-items: center;
	gap: 16px;
}

.header-titles {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.roster-title {
	font-size: 28px;
	font-weight: 700;
	color: #ffffff;
}

.roster-subtitle {
	font-size: 14px;
	color: rgba(255, 255, 255, 0.5);
}

.header-right {
	display: flex;
	align-items: center;
	gap: 16px;
}

.back-btn {
	width: 44px;
	height: 44px;
	background-color: rgba(255, 255, 255, 0.08);
	border: 1px solid rgba(255, 255, 255, 0.15);
	border-radius: 10px;
	font-size: 20px;
	font-weight: 700;
	color: rgba(255, 255, 255, 0.7);
	cursor: pointer;
	transition: all 0.2s ease;
	display: flex;
	align-items: center;
	justify-content: center;
	pointer-events: all;

	&:hover {
		background-color: rgba(255, 255, 255, 0.15);
		color: #ffffff;
		transform: translateX(-2px);
	}
}

.team-counter {
	display: flex;
	align-items: baseline;
	gap: 4px;
	padding: 10px 18px;
	background-color: rgba(139, 92, 246, 0.25);
	border: 1px solid rgba(139, 92, 246, 0.5);
	border-radius: 10px;

	.count-current {
		font-size: 28px;
		font-weight: 800;
		color: #ffffff;
		text-shadow: 0 0 8px rgba(139, 92, 246, 0.6);
	}

	.count-divider {
		font-size: 20px;
		color: rgba(255, 255, 255, 0.5);
	}

	.count-max {
		font-size: 20px;
		font-weight: 600;
		color: rgba(255, 255, 255, 0.7);
	}
}

// Controls row below header
.expedition-controls {
	display: flex;
	align-items: center;
	gap: 10px;
	flex-wrap: wrap;
	margin-bottom: 0px;
	position: relative;
	z-index: 200;

	.dropdown-icon {
		margin-top: 9px;
	}

	.item-icon {
		margin-top: 9px;
	}
}

.auto-toggles {
	display: flex;
	align-items: center;
	gap: 10px;
}

.header-actions {
	display: flex;
	align-items: center;
	gap: 10px;
	flex-wrap: wrap;
}

// Auto Battle Toggle - matches FilterBar style with higher opacity for expedition background
.auto-battle-toggle {
	display: flex;
	align-items: center;
	gap: 10px;
	cursor: pointer;
	padding: 10px 16px;
	background-color: rgba(40, 35, 55, 0.9);
	border-radius: 8px;
	border: 1px solid rgba(255, 255, 255, 0.18);
	transition: all 0.2s ease;
	pointer-events: all;

	&:hover {
		background-color: rgba(50, 45, 70, 0.95);
		border-color: rgba(255, 255, 255, 0.3);
	}

	.toggle-slider {
		width: 36px;
		height: 18px;
		background-color: rgba(255, 255, 255, 0.25);
		border-radius: 9px;
		position: relative;
		transition: all 0.3s ease;

		&::after {
			content: "";
			position: absolute;
			top: 2px;
			left: 2px;
			width: 14px;
			height: 14px;
			background-color: rgba(255, 255, 255, 0.8);
			border-radius: 50%;
			transition: all 0.3s ease;
		}
	}

	.toggle-label {
		font-size: 14px;
		font-weight: 600;
		color: rgba(255, 255, 255, 0.9);
	}

	&.active {
		background-color: rgba(139, 92, 246, 0.3);
		border-color: rgba(139, 92, 246, 0.5);

		.toggle-slider {
			background-image: linear-gradient(135deg, #8b5cf6, #6d28d9);

			&::after {
				left: 18px;
				background-color: #ffffff;
			}
		}

		.toggle-label {
			color: #ffffff;
		}
	}
}

// Dropdown container (shared with FilterBar style)
.dropdown-container {
	position: relative;
	pointer-events: all;
	z-index: 100;
}

// Dropdown button - matches FilterBar style with higher opacity for expedition background
.dropdown-btn {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 10px 16px;
	font-size: 14px;
	font-weight: 600;
	color: rgba(255, 255, 255, 0.9);
	background-color: rgba(40, 35, 55, 0.9);
	border: 1px solid rgba(255, 255, 255, 0.18);
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.2s ease;
	white-space: nowrap;

	&:hover {
		background-color: rgba(50, 45, 70, 0.95);
		border-color: rgba(255, 255, 255, 0.3);
	}

	.dropdown-icon {
		font-size: 14px;
		flex-shrink: 0;
	}

	.dropdown-label {
		white-space: nowrap;
	}

	.dropdown-value {
		white-space: nowrap;
		padding: 2px 8px;
		background-color: rgba(255, 255, 255, 0.1);
		border-radius: 4px;
		font-size: 12px;
		color: rgba(255, 255, 255, 0.6);

		&.enabled {
			background-color: rgba(139, 92, 246, 0.3);
			color: #a78bfa;
		}
	}

	.dropdown-arrow {
		font-size: 10px;
		color: rgba(255, 255, 255, 0.5);
		transition: transform 0.2s ease;
		flex-shrink: 0;

		&.open {
			transform: rotate(180deg);
		}
	}

	// Hard mode active state
	&.hard-active {
		background-color: rgba(239, 68, 68, 0.2);
		border-color: rgba(239, 68, 68, 0.5);
		color: #fca5a5;
	}

	// Auto catch active state
	&.active {
		background-color: rgba(139, 92, 246, 0.2);
		border-color: rgba(139, 92, 246, 0.4);
	}
}

// Dropdown menu
.dropdown-menu {
	position: absolute;
	top: 46px;
	left: 0;
	min-width: 180px;
	max-height: 300px;
	overflow-y: scroll;
	background-color: rgba(15, 10, 30, 0.98);
	border: 1px solid rgba(139, 92, 246, 0.3);
	border-radius: 10px;
	padding: 6px;
	z-index: 9999;
	box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
	animation: dropdownFadeIn 0.15s ease-out;

	&.catch-menu {
		min-width: 200px;
	}
}

@keyframes dropdownFadeIn {
	from {
		opacity: 0;
		transform: translateY(-8px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

// Dropdown item
.dropdown-item {
	display: flex;
	align-items: center;
	gap: 10px;
	padding: 10px 14px;
	margin-right: 8px;
	font-size: 14px;
	font-weight: 500;
	color: rgba(255, 255, 255, 0.7);
	border-radius: 6px;
	cursor: pointer;
	transition: all 0.15s ease;

	&:last-child {
		margin-right: 0;
	}

	&:hover {
		background-color: rgba(139, 92, 246, 0.2);
		color: #ffffff;
	}

	&.active {
		background-color: rgba(139, 92, 246, 0.35);
		color: #ffffff;

		.item-icon {
			color: #a78bfa;
		}
	}

	.item-icon {
		font-size: 14px;
		width: 20px;
		text-align: center;
	}

	.item-label {
		flex: 1;
	}

	.item-hint {
		font-size: 11px;
		color: rgba(255, 255, 255, 0.4);
	}

	.item-cost {
		font-size: 12px;
		color: rgba(255, 255, 255, 0.5);
	}

	// Hard mode item styling
	&.hard {
		&.active {
			background-color: rgba(239, 68, 68, 0.3);
			color: #fca5a5;

			.item-icon {
				color: #f87171;
			}
		}

		&:hover:not(.locked) {
			background-color: rgba(239, 68, 68, 0.2);
		}
	}

	// Locked state
	&.locked {
		cursor: not-allowed;
		opacity: 0.6;

		.item-icon {
			color: rgba(255, 255, 255, 0.4);
		}

		.item-label {
			color: rgba(255, 255, 255, 0.4);
		}

		&:hover {
			background-color: transparent;
			color: rgba(255, 255, 255, 0.4);
		}
	}
}

// Dropdown divider
.dropdown-divider {
	height: 1px;
	background-color: rgba(255, 255, 255, 0.1);
	margin: 6px 8px;
}


.btn-back {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 10px 16px;
	background-color: rgba(255, 255, 255, 0.05);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 10px;
	color: rgba(255, 255, 255, 0.7);
	font-size: 14px;
	font-weight: 600;
	cursor: pointer;
	transition: all 0.2s ease;
	pointer-events: all;

	&:hover {
		background-color: rgba(255, 255, 255, 0.1);
		color: #ffffff;
	}
}

// ============================================
// EXPEDITION GRID
// ============================================
.expedition-grid {
	flex: 1;
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
	overflow-y: hidden;
	overflow-x: hidden;
	padding: 6px 0px 6px 0px;
	pointer-events: all;
	align-content: flex-start;
	justify-content: center;
	min-height: 0;
	position: relative;
	z-index: 1;
}

// Staggered entrance animation for expedition cards
@keyframes cardEnter {
	from {
		opacity: 0;
		transform: translateY(20px) scale(0.95);
	}
	to {
		opacity: 1;
		transform: translateY(0) scale(1);
	}
}

// Subtle floating animation on hover
@keyframes cardFloat {
	0%, 100% {
		transform: translateY(-6px) scale(1.02);
	}
	50% {
		transform: translateY(-10px) scale(1.02);
	}
}

.expedition-card {
	display: flex;
	flex-direction: column;
	gap: 6px;
	padding: 14px;
	background-color: rgba(12, 10, 24, 0.95);
	border: 2px solid rgba(255, 255, 255, 0.12);
	border-radius: 10px;
	cursor: pointer;
	transition: transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
	position: relative;
	pointer-events: all;
	width: 465px;
	height: 165px;
	flex-shrink: 0;
	flex-grow: 0;
	overflow: hidden;
	box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);

	// Staggered entrance animation - only on first load
	&.animate-entrance {
		animation: cardEnter 0.35s ease-out both;

		// Stagger delays for each card
		&:nth-child(1) { animation-delay: 0ms; }
		&:nth-child(2) { animation-delay: 50ms; }
		&:nth-child(3) { animation-delay: 100ms; }
		&:nth-child(4) { animation-delay: 150ms; }
		&:nth-child(5) { animation-delay: 200ms; }
		&:nth-child(6) { animation-delay: 250ms; }
		&:nth-child(7) { animation-delay: 300ms; }
		&:nth-child(8) { animation-delay: 350ms; }
		&:nth-child(9) { animation-delay: 400ms; }
		&:nth-child(10) { animation-delay: 450ms; }
	}

	// Background image for cards with location art
	&.has-background {
		// Remove default background so only the image shows
		background-color: transparent;

		&::before {
			content: "";
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-size: cover;
			background-position: center top;
			opacity: 1;
			z-index: 0;
			pointer-events: none;
			transition: transform 0.4s ease-out;
		}

		.card-body {
			position: relative;
			z-index: 2;
		}

		.card-title {
			text-shadow: 0 1px 3px rgba(0, 0, 0, 1), 0 0 12px rgba(0, 0, 0, 0.8);
		}

		// Keep element icon in correct position (already absolute)
		.card-element {
			z-index: 2;
		}

		.card-stats {
			position: relative;
			z-index: 2;
		}

		.card-rewards {
			position: relative;
			z-index: 2;
		}

		.card-info-buttons {
			position: relative;
			z-index: 2;
		}
	}

	// Gradient overlay element (real div, not pseudo-element)
	.card-gradient-overlay {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background-image: linear-gradient(to right, rgba(0, 0, 0, 0.92) 0%, rgba(0, 0, 0, 0.7) 40%, rgba(0, 0, 0, 0.2) 70%, rgba(0, 0, 0, 0.0) 100%);
		border-radius: 8px;
		z-index: 1;
		pointer-events: none;
		transition: opacity 0.3s ease;
	}

	// Whispering Woods background
	&.bg-forest_entrance::before {
		background-image: url(ui/locations/whispering_woods_background.png);
	}

	// Ember Cavern background
	&.bg-ember_cavern::before {
		background-image: url(ui/locations/ember_cavern_background.png);
	}

	// Lake of Tears background
	&.bg-tear_lake::before {
		background-image: url(ui/locations/lake_of_tears_background.png);
	}

	// Echo Canyon background
	&.bg-echo_canyon::before {
		background-image: url(ui/locations/echo_canyon_background.png);
	}

	// Storm Spire background
	&.bg-storm_spire::before {
		background-image: url(ui/locations/storm_spire_background.png);
	}

	// Ancient Ruins background
	&.bg-ancient_ruins::before {
		background-image: url(ui/locations/ancient_ruins_background.png);
	}

	// Frozen Vale background
	&.bg-frozen_vale::before {
		background-image: url(ui/locations/frozen_vale_background.png);
	}

	// Overgrown Heart background
	&.bg-overgrown_heart::before {
		background-image: url(ui/locations/overgrown_heart_background.png);
	}

	// Rusted Foundry background
	&.bg-rusted_foundry::before {
		background-image: url(ui/locations/rusted_foundry_background.png);
	}

	// Spirit Sanctum background
	&.bg-spirit_sanctum::before {
		background-image: url(ui/locations/spirit_sanctum_background.png);
	}

	// Shadow Depths background
	&.bg-shadow_depths::before {
		background-image: url(ui/locations/shadow_depths_background.png);
	}

	// Elemental Nexus background
	&.bg-elemental_nexus::before {
		background-image: url(ui/locations/elemental_nexus_background.png);
	}

	// Primordial Rift background
	&.bg-primordial_rift::before {
		background-image: url(ui/locations/primordial_rift_background.png);
	}

	// Garden of Origins background
	&.bg-garden_of_origins::before {
		background-image: url(ui/locations/garden_of_origins_background.png);
	}

	// Mythweaver's Realm background
	&.bg-mythweavers_realm::before {
		background-image: url(ui/locations/mythweavers_realm_background.png);
	}

	// The Origin Void background
	&.bg-origin_void::before {
		background-image: url(ui/locations/the_origin_void_background.png);
	}

	&:hover {
		transform: translateY(-2px);
		border-color: rgba(139, 92, 246, 0.7);
		box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5), 0 0 16px rgba(139, 92, 246, 0.2);

		// Zoom background image on hover
		&::before {
			transform: scale(1.03);
		}

		// Brighten the gradient overlay slightly
		.card-gradient-overlay {
			opacity: 0.9;
		}
	}

	&.selected {
		border-color: #a78bfa;
		box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 0 12px rgba(139, 92, 246, 0.3);

		// Only apply background if not using location art
		&:not(.has-background) {
			background-color: rgba(139, 92, 246, 0.1);
		}
	}

	.card-select-team-btn {
		position: absolute;
		bottom: 10px;
		right: 10px;
		z-index: 10;
		padding: 8px 16px;
		background: linear-gradient(135deg, #6d28d9, #7c3aed);
		border: 1px solid rgba(167, 139, 250, 0.6);
		border-radius: 6px;
		color: #ffffff;
		font-size: 13px;
		font-weight: 700;
		letter-spacing: 1px;
		cursor: pointer;
		pointer-events: all;
		transition: all 0.2s ease;
		text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
		box-shadow: 0 2px 10px rgba(88, 28, 195, 0.5);
		animation: slideUpFade 0.15s ease-out;
		backdrop-filter: blur(4px);

		&:hover {
			background: rgba(109, 40, 217, 0.95);
			border-color: rgba(167, 139, 250, 0.7);
			box-shadow: 0 4px 16px rgba(109, 40, 217, 0.6);
			text-shadow: 0 0 10px rgba(196, 181, 253, 0.5), 0 1px 3px rgba(0, 0, 0, 0.5);
		}
	}

	@keyframes slideUpFade {
		from { opacity: 0; transform: translateY(4px); }
		to { opacity: 1; transform: translateY(0); }
	}

	&.locked {
		cursor: not-allowed;
		opacity: 0.5;
		filter: grayscale(70%);

		&:hover {
			transform: none;
			border-color: rgba(255, 255, 255, 0.08);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
		}

		// Keep the locked overlay visible and clear
		.locked-overlay {
			opacity: 1;
			filter: grayscale(0%);
		}
	}

	&.cleared {
		// Cleared status indicated by checkmark - no special border needed
	}
}

.card-element {
	width: 48px;
	height: 48px;
	min-width: 48px;
	border-radius: 10px;
	display: flex;
	justify-content: center;
	align-items: center;
	position: absolute;
	top: 12px;
	right: 12px;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
	border: 2px solid rgba(255, 255, 255, 0.25);

	&.fire { background-image: linear-gradient(135deg, #ef4444, #b91c1c); }
	&.water { background-image: linear-gradient(135deg, #3b82f6, #1d4ed8); }
	&.earth { background-image: linear-gradient(135deg, #a16207, #713f12); }
	&.wind { background-image: linear-gradient(135deg, #22c55e, #15803d); }
	&.electric { background-image: linear-gradient(135deg, #facc15, #ca8a04); }
	&.ice { background-image: linear-gradient(135deg, #7dd3fc, #0ea5e9); }
	&.nature { background-image: linear-gradient(135deg, #4ade80, #16a34a); }
	&.metal { background-image: linear-gradient(135deg, #94a3b8, #475569); }
	&.shadow { background-image: linear-gradient(135deg, #7c3aed, #4c1d95); }
	&.spirit { background-image: linear-gradient(135deg, #ec4899, #be185d); }
	&.neutral { background-image: linear-gradient(135deg, #6b7280, #374151); }

	.element-icon {
		font-size: 24px;
		filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
	}
}

.card-body {
	flex: 1;
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.card-title {
	font-size: 18px;
	font-weight: 800;
	color: #ffffff;
	padding-right: 48px;
	letter-spacing: 0.3px;
	text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
}

.card-desc {
	display: none; // Hide description in compact mode
}

.card-stats {
	display: flex;
	flex-wrap: wrap;
	gap: 6px;
	margin-top: 4px;
}

.stat-badge {
	display: flex;
	align-items: center;
	gap: 5px;
	padding: 4px 10px;
	background-color: rgba(0, 0, 0, 0.6);
	border: 1px solid rgba(255, 255, 255, 0.15);
	border-radius: 6px;
	transition: all 0.2s ease;

	.stat-icon {
		font-size: 12px;
		opacity: 0.9;
	}

	.stat-value {
		font-size: 12px;
		font-weight: 700;
		color: rgba(255, 255, 255, 0.95);
		white-space: nowrap;
	}

	// Hard mode level indicator
	&.hard-mode {
		background-color: rgba(239, 68, 68, 0.25);
		border: 1px solid rgba(239, 68, 68, 0.6);
		box-shadow: 0 0 8px rgba(239, 68, 68, 0.3);

		.stat-icon {
			color: #fca5a5;
		}

		.stat-value {
			color: #fca5a5;
			font-weight: 700;
		}
	}
}

.card-rewards {
	display: flex;
	gap: 6px;
	margin-top: 4px;
}

.reward-badge {
	display: flex;
	align-items: center;
	gap: 5px;
	padding: 4px 10px;
	border-radius: 6px;
	font-size: 12px;
	font-weight: 700;
	white-space: nowrap;
	transition: all 0.2s ease;
	border: 1px solid transparent;

	&.gold {
		background-color: rgba(251, 191, 36, 0.15);
		border-color: rgba(251, 191, 36, 0.3);
		color: #fcd34d;

		&.boosted {
			background-color: rgba(251, 191, 36, 0.25);
			border-color: rgba(251, 191, 36, 0.5);
			box-shadow: 0 0 8px rgba(251, 191, 36, 0.2);
		}
	}

	&.xp {
		background-color: rgba(167, 139, 250, 0.15);
		border-color: rgba(167, 139, 250, 0.3);
		color: #c4b5fd;

		&.boosted {
			background-color: rgba(167, 139, 250, 0.25);
			border-color: rgba(167, 139, 250, 0.5);
			box-shadow: 0 0 8px rgba(167, 139, 250, 0.2);
		}
	}
}

.locked-overlay {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.7);
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	gap: 4px;
	border-radius: 8px;
	z-index: 2;

	.lock-icon {
		font-size: 28px;
		filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.8));
	}

	.lock-text {
		font-size: 12px;
		font-weight: 700;
		color: #ffffff;
		text-shadow: 0 2px 4px rgba(0, 0, 0, 1);
	}
}

.cleared-mark {
	position: absolute;
	top: 8px;
	right: 8px;
	width: 20px;
	height: 20px;
	background-color: #22c55e;
	border-radius: 50%;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 12px;
	font-weight: 800;
	color: #ffffff;
}

// ============================================
// TEAM SELECTION
// ============================================

// Team view base styles (applied to expedition-panel)
.expedition-panel.team-view {
	background-size: cover;
	background-position: center;

	// Dark overlay for readability
	&::before {
		content: "";
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background-image: linear-gradient(180deg, rgba(8, 8, 18, 0.85), rgba(15, 12, 30, 0.92));
		z-index: 0;
		pointer-events: none;
	}

	// Improve readability of elements over background
	.panel-title {
		text-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
	}

	.panel-subtitle {
		text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
	}

	.available-label {
		text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
	}
}

// Expedition-specific backgrounds for team view
.expedition-panel.team-view.expedition-bg-forest {
	background-image: url(ui/locations/whispering_woods_background.png);
}

.expedition-panel.team-view.expedition-bg-ember {
	background-image: url(ui/locations/ember_cavern_background.png);
}

.expedition-panel.team-view.expedition-bg-tear_lake {
	background-image: url(ui/locations/lake_of_tears_background.png);
}

.expedition-panel.team-view.expedition-bg-echo_canyon {
	background-image: url(ui/locations/echo_canyon_background.png);
}

.expedition-panel.team-view.expedition-bg-storm_spire {
	background-image: url(ui/locations/storm_spire_background.png);
}

.expedition-panel.team-view.expedition-bg-ancient_ruins {
	background-image: url(ui/locations/ancient_ruins_background.png);
}

.expedition-panel.team-view.expedition-bg-frozen_vale {
	background-image: url(ui/locations/frozen_vale_background.png);
}

.expedition-panel.team-view.expedition-bg-overgrown_heart {
	background-image: url(ui/locations/overgrown_heart_background.png);
}

.expedition-panel.team-view.expedition-bg-rusted_foundry {
	background-image: url(ui/locations/rusted_foundry_background.png);
}

.expedition-panel.team-view.expedition-bg-spirit_sanctum {
	background-image: url(ui/locations/spirit_sanctum_background.png);
}

.expedition-panel.team-view.expedition-bg-shadow_depths {
	background-image: url(ui/locations/shadow_depths_background.png);
}

.expedition-panel.team-view.expedition-bg-elemental_nexus {
	background-image: url(ui/locations/elemental_nexus_background.png);
}

.expedition-panel.team-view.expedition-bg-primordial_rift {
	background-image: url(ui/locations/primordial_rift_background.png);
}

.expedition-panel.team-view.expedition-bg-garden_of_origins {
	background-image: url(ui/locations/garden_of_origins_background.png);
}

.expedition-panel.team-view.expedition-bg-mythweavers_realm {
	background-image: url(ui/locations/mythweavers_realm_background.png);
}

.expedition-panel.team-view.expedition-bg-origin_void {
	background-image: url(ui/locations/the_origin_void_background.png);
}

// Ensure content is above overlay for team-view
.expedition-panel.team-view > * {
	position: relative;
	z-index: 1;
}

// Battle mode background
.expedition-panel.battle-mode {
	// Remove padding so absolute BattleView can fill to edges
	padding: 0;
	gap: 0;
	min-width: 100%;
	min-height: 100%;
	// Hide the default background overlay in battle mode
	background-image: none;

	&::before {
		display: none;
	}
}

.team-selection {
	flex: 1;
	display: flex;
	flex-direction: row;
	gap: 16px;
	overflow: visible;
	position: relative;
	z-index: 1;
	min-height: 0;
}

// Left side container (filters + monster grid)
.selection-left {
	flex: 1;
	display: flex;
	flex-direction: column;
	gap: 12px;
	min-width: 0;
	min-height: 0;
	overflow: visible;
}

// Top filter bar area
.selection-top {
	display: flex;
	align-items: center;
	gap: 16px;
	flex-shrink: 0;
	position: relative;
	z-index: 200;
	overflow: visible;
}

// ============================================
// FILTER AND SORT BAR
// ============================================

.selection-filters {
	display: flex;
	flex-direction: column;
	gap: 10px;
	flex-shrink: 0;
	position: relative;
	z-index: 100;
}

.roster-filters {
	display: flex;
	gap: 8px;
	flex-wrap: wrap;
}

.filter-btn {
	padding: 10px 20px;
	font-size: 15px;
	font-weight: 600;
	color: rgba(255, 255, 255, 0.6);
	background-color: rgba(255, 255, 255, 0.05);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.2s ease;
	pointer-events: all;

	&:hover {
		background-color: rgba(255, 255, 255, 0.1);
		color: #ffffff;
	}

	&.active {
		background-color: rgba(139, 92, 246, 0.3);
		border-color: rgba(139, 92, 246, 0.5);
		color: #ffffff;
	}

	// Element colors
	&.fire { background: #b91c1c; border-color: #dc2626; color: #ffffff; }
	&.fire.active { background: #ef4444; border-color: #f87171; }

	&.water { background: #1d4ed8; border-color: #2563eb; color: #ffffff; }
	&.water.active { background: #3b82f6; border-color: #60a5fa; }

	&.earth { background: #78350f; border-color: #92400e; color: #ffffff; }
	&.earth.active { background: #a16207; border-color: #ca8a04; }

	&.wind { background: #15803d; border-color: #16a34a; color: #ffffff; }
	&.wind.active { background: #22c55e; border-color: #4ade80; }

	&.electric { background: #a16207; border-color: #ca8a04; color: #ffffff; }
	&.electric.active { background: #facc15; border-color: #fde047; color: #1f2937; }

	&.ice { background: #0284c7; border-color: #0ea5e9; color: #ffffff; }
	&.ice.active { background: #38bdf8; border-color: #7dd3fc; }

	&.nature { background: #166534; border-color: #15803d; color: #ffffff; }
	&.nature.active { background: #4ade80; border-color: #86efac; color: #1f2937; }

	&.metal { background: #475569; border-color: #64748b; color: #ffffff; }
	&.metal.active { background: #94a3b8; border-color: #cbd5e1; color: #1f2937; }

	&.shadow { background: #4c1d95; border-color: #5b21b6; color: #ffffff; }
	&.shadow.active { background: #7c3aed; border-color: #a78bfa; }

	&.spirit { background: #9d174d; border-color: #be185d; color: #ffffff; }
	&.spirit.active { background: #ec4899; border-color: #f472b6; }
}

.roster-sort {
	display: flex;
	align-items: center;
	gap: 8px;
}

.sort-label {
	font-size: 13px;
	font-weight: 600;
	color: rgba(255, 255, 255, 0.4);
	margin-right: 4px;
}

.sort-btn {
	padding: 6px 12px;
	font-size: 13px;
	font-weight: 600;
	color: rgba(255, 255, 255, 0.6);
	background-color: rgba(255, 255, 255, 0.05);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 6px;
	cursor: pointer;
	transition: all 0.2s ease;
	pointer-events: all;

	&:hover {
		background-color: rgba(255, 255, 255, 0.1);
		color: #ffffff;
	}

	&.active {
		background-color: rgba(139, 92, 246, 0.3);
		border-color: rgba(139, 92, 246, 0.5);
		color: #ffffff;
	}

	&.fav {
		color: rgba(251, 191, 36, 0.8);

		&:hover {
			background-color: rgba(251, 191, 36, 0.15);
			color: #fbbf24;
		}

		&.active {
			background-color: rgba(251, 191, 36, 0.25);
			border-color: rgba(251, 191, 36, 0.5);
			color: #fbbf24;
		}
	}
}

// ============================================
// MONSTER GRID
// ============================================

.available-monsters {
	flex: 1;
	display: flex;
	flex-wrap: wrap;
	gap: 8px;
	overflow-y: scroll;
	overflow-x: hidden;
	padding: 10px;
	align-content: flex-start;
	min-height: 0;
	background-color: rgba(0, 0, 0, 0.25);
	border-radius: 12px;
	border: 1px solid rgba(255, 255, 255, 0.05);
	position: relative;
	z-index: 1;
}

.no-monsters {
	width: 100%;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	gap: 8px;
	padding: 40px;
	color: rgba(255, 255, 255, 0.4);

	.empty-icon {
		font-size: 48px;
		opacity: 0.3;
	}

	.empty-text {
		font-size: 16px;
		font-weight: 600;
	}

	.empty-hint {
		font-size: 13px;
		opacity: 0.6;
	}
}

// Container for team slots (right side)
.team-section {
	width: 340px;
	flex-shrink: 0;
	display: flex;
	flex-direction: column;
	gap: 10px;
}

.team-label {
	font-size: 11px;
	font-weight: 700;
	color: rgba(255, 255, 255, 0.5);
	text-transform: uppercase;
	letter-spacing: 1px;
	text-align: center;
	padding-bottom: 4px;
}

.selected-team {
	display: flex;
	flex-direction: column;
	gap: 10px;
	flex: 1;
}

.btn-start {
	width: 100%;
}

.team-slot {
	flex: 1;
	min-height: 140px;
	border-radius: 12px;
	position: relative;
	transition: all 0.2s ease;
	pointer-events: all;
	overflow: hidden;

	&.empty {
		background-color: rgba(0, 0, 0, 0.3);
		border: 2px solid rgba(255, 255, 255, 0.1);
		display: flex;
		justify-content: center;
		align-items: center;
	}

	&.filled {
		cursor: pointer;
		border: 2px solid rgba(139, 92, 246, 0.3);
		background-color: rgba(0, 0, 0, 0.35);

		// Make MonsterCard fill the slot
		MonsterCard {
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			width: 100%;
			height: 100%;
		}

		.monster-card {
			width: 100%;
			height: 100%;
			border-radius: 10px;
		}

		&:hover {
			border-color: rgba(239, 68, 68, 0.5);
			background-color: rgba(239, 68, 68, 0.1);
		}
	}
}

.slot-empty {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 4px;

	.slot-number {
		font-size: 36px;
		font-weight: 800;
		color: rgba(255, 255, 255, 0.25);
	}

	.slot-label {
		font-size: 12px;
		font-weight: 600;
		color: rgba(255, 255, 255, 0.4);
		text-transform: uppercase;
		letter-spacing: 1px;
	}
}

.monster-option {
	border-radius: 16px;
	transition: all 0.2s ease;
	pointer-events: all;

	&:hover {
		transform: translateY(-4px);
	}

	&.in-team {
		opacity: 0.4;
		pointer-events: none;
	}
}

// ============================================
// SELECTION TOP (Filters + Tooltip row)
// ============================================
.selection-top {
	display: flex;
	align-items: center;
	gap: 16px;
	flex-shrink: 0;
	margin-bottom: 12px;
}

// ============================================
// MONSTER HOVER TOOLTIP (horizontal bar)
// ============================================
.monster-hover-tooltip {
	display: flex;
	align-items: center;
	gap: 10px;
	padding: 6px 12px;
	background-color: rgba(20, 20, 35, 0.95);
	border: 2px solid rgba(139, 92, 246, 0.4);
	border-radius: 8px;
	box-shadow: 0 2px 8px rgba(139, 92, 246, 0.2);
	pointer-events: none;
	flex-shrink: 0;

	.tooltip-name {
		font-size: 14px;
		font-weight: 700;
		color: #ffffff;
		white-space: nowrap;
	}

	.tooltip-level {
		font-size: 12px;
		font-weight: 600;
		color: rgba(255, 255, 255, 0.6);
		white-space: nowrap;
	}

	.tooltip-element {
		font-size: 11px;
		font-weight: 600;
		padding: 3px 8px;
		border-radius: 4px;
		color: #ffffff;

		&.fire { background: linear-gradient(135deg, #ef4444, #dc2626); }
		&.water { background: linear-gradient(135deg, #3b82f6, #2563eb); }
		&.earth { background: linear-gradient(135deg, #a16207, #854d0e); }
		&.wind { background: linear-gradient(135deg, #22c55e, #16a34a); }
		&.electric { background: linear-gradient(135deg, #facc15, #eab308); }
		&.ice { background: linear-gradient(135deg, #7dd3fc, #38bdf8); }
		&.nature { background: linear-gradient(135deg, #4ade80, #22c55e); }
		&.metal { background: linear-gradient(135deg, #94a3b8, #64748b); }
		&.shadow { background: linear-gradient(135deg, #6b21a8, #581c87); }
		&.spirit { background: linear-gradient(135deg, #ec4899, #db2777); }
		&.neutral { background: linear-gradient(135deg, #6b7280, #4b5563); }
	}

	.tooltip-stat {
		display: flex;
		align-items: center;
		gap: 4px;

		.stat-name {
			font-size: 10px;
			font-weight: 700;
			color: rgba(255, 255, 255, 0.5);
			text-transform: uppercase;
		}

		.stat-val {
			font-size: 12px;
			font-weight: 600;
			color: #ffffff;
		}
	}

	.tooltip-genes {
		display: flex;
		align-items: center;
		gap: 4px;
		padding: 3px 8px;
		background-color: rgba(0, 0, 0, 0.2);
		border-radius: 4px;

		.genes-label {
			font-size: 10px;
			color: rgba(255, 255, 255, 0.5);
		}

		.genes-value {
			font-size: 12px;
			font-weight: 700;
			color: #a855f7;
		}
	}

	.tooltip-traits {
		display: flex;
		align-items: center;
		gap: 4px;

		.trait-badge {
			font-size: 10px;
			font-weight: 600;
			padding: 2px 6px;
			background-color: rgba(139, 92, 246, 0.3);
			border: 1px solid rgba(139, 92, 246, 0.5);
			border-radius: 4px;
			color: #c4b5fd;
		}
	}
}

.no-monsters {
	width: 100%;
	padding: 40px;
	text-align: center;
	color: rgba(255, 255, 255, 0.4);
	font-size: 16px;
}

// ============================================
// CONTRACT TARGET SEARCH POPUP
// ============================================
.contract-search-overlay {
	position: absolute;
	top: 0;
	left: 0;
	width: 1920px;
	height: 1080px;
	background-color: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 2000;
	pointer-events: all;
	overflow-x: hidden;
	overflow-y: hidden;
}

.contract-search-popup {
	width: 500px;
	height: 500px;
	background-color: rgba(15, 10, 30, 0.98);
	border: 2px solid rgba(139, 92, 246, 0.5);
	border-radius: 16px;
	display: flex;
	flex-direction: column;
	box-shadow: 0 16px 64px rgba(0, 0, 0, 0.8);
	animation: contractSearchSlideIn 0.2s ease-out;
}

@keyframes contractSearchSlideIn {
	from { opacity: 0; transform: scale(0.95); }
	to { opacity: 1; transform: scale(1); }
}

.contract-search-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 16px 20px;
	border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.contract-search-title {
	font-size: 18px;
	font-weight: 600;
	color: #ffffff;
}

.contract-search-close {
	width: 32px;
	height: 32px;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 20px;
	color: rgba(255, 255, 255, 0.5);
	background-color: rgba(255, 255, 255, 0.05);
	border: none;
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.15s ease;

	&:hover {
		background-color: rgba(239, 68, 68, 0.3);
		color: #ef4444;
	}
}

.contract-search-input-wrapper {
	padding: 16px 20px;
}

.contract-search-input {
	width: 100%;
	padding: 12px 16px;
	font-size: 16px;
	color: #ffffff;
	background-color: rgba(255, 255, 255, 0.08);
	border: 1px solid rgba(255, 255, 255, 0.15);
	border-radius: 8px;

	&:focus {
		border-color: rgba(139, 92, 246, 0.5);
		background-color: rgba(255, 255, 255, 0.1);
	}
}

.contract-search-results {
	flex: 1;
	flex-direction: column;
	flex-wrap: nowrap;
	overflow-x: hidden;
	overflow-y: scroll;
	padding: 0 12px 12px 12px;

	.result-number {
		font-size: 12px;
		font-weight: 600;
		color: rgba(255, 255, 255, 0.4);
		width: 32px;
	}

	.result-element {
		font-size: 14px;
		width: 20px;
	}

	.result-name {
		font-size: 15px;
	}
}

.contract-search-result {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 10px 14px;
	font-size: 15px;
	font-weight: 500;
	color: rgba(255, 255, 255, 0.8);
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.15s ease;

	&:hover {
		background-color: rgba(139, 92, 246, 0.25);
		color: #ffffff;
	}

	&.active {
		background-color: rgba(139, 92, 246, 0.2);
		border: 1px solid rgba(139, 92, 246, 0.4);
		color: #c4b5fd;
	}
}

.contract-search-empty {
	padding: 24px;
	text-align: center;
	font-size: 14px;
	color: rgba(255, 255, 255, 0.4);
}

// ============================================
// ACTION BAR
// ============================================
.action-bar {
	display: flex;
	justify-content: center;
	gap: 16px;
	padding: 16px 24px;
	border-top: 1px solid rgba(255, 255, 255, 0.1);
	flex-shrink: 0;
	position: relative;
	z-index: 1;
	background-color: rgba(0, 0, 0, 0.3);
	border-radius: 12px;
	backdrop-filter: blur(8px);
}

.btn-primary, .btn-success, .btn-warning, .btn-secondary {
	padding: 16px 40px;
	font-size: 16px;
	font-weight: 700;
	letter-spacing: 2px;
	border-radius: 14px;
	cursor: pointer;
	transition: all 0.2s ease;
	pointer-events: all;
	border: 2px solid transparent;

	&:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
	}

	&:active {
		transform: translateY(0);
	}
}

.btn-primary {
	background-image: linear-gradient(135deg, #8b5cf6, #6d28d9);
	border-color: #a78bfa;
	color: #ffffff;

	&:hover {
		background-image: linear-gradient(135deg, #a78bfa, #8b5cf6);
	}

	&.disabled {
		opacity: 0.4;
		cursor: not-allowed;
		&:hover {
			transform: none;
			box-shadow: none;
		}
	}
}

.btn-success {
	background-image: linear-gradient(135deg, #22c55e, #16a34a);
	border-color: #4ade80;
	color: #ffffff;

	&:hover {
		background-image: linear-gradient(135deg, #4ade80, #22c55e);
	}
}

.btn-warning {
	background-image: linear-gradient(135deg, #f59e0b, #d97706);
	border-color: #fbbf24;
	color: #ffffff;

	&:hover {
		background-image: linear-gradient(135deg, #fbbf24, #f59e0b);
	}
}

.btn-secondary {
	background-color: rgba(255, 255, 255, 0.08);
	border-color: rgba(255, 255, 255, 0.15);
	color: rgba(255, 255, 255, 0.8);

	&:hover {
		background-color: rgba(255, 255, 255, 0.12);
		color: #ffffff;
	}
}

// ============================================
// RESULT VIEW
// ============================================

// Result screen animations
@keyframes resultFadeIn {
	from { opacity: 0; transform: translateX(-40px); }
	to { opacity: 1; transform: translateX(0); }
}

@keyframes resultIconEnter {
	from { opacity: 0; transform: scale(0.5); }
	to { opacity: 1; transform: scale(1); }
}

@keyframes resultTitleEnter {
	from { opacity: 0; transform: translateY(-10px); }
	to { opacity: 1; transform: translateY(0); }
}

@keyframes rewardSlideIn {
	from { opacity: 0; transform: translateY(10px); }
	to { opacity: 1; transform: translateY(0); }
}

.result-view {
	flex: 1;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	gap: 28px;
	text-align: center;
	animation: resultFadeIn 0.3s ease-out;
	padding: 40px;
}

.result-banner {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 12px;
	padding: 32px 64px;
	background-color: rgba(0, 0, 0, 0.5);
	border-radius: 24px;
	border: 2px solid rgba(255, 255, 255, 0.1);
}

.result-icon {
	font-size: 72px;
	animation: resultIconEnter 0.2s ease-out;
}

.result-title {
	font-size: 52px;
	font-weight: 900;
	letter-spacing: 8px;
	text-transform: uppercase;
	animation: resultTitleEnter 0.18s ease-out;
	color: #ffffff;
}

// Victory state - explicit selectors for S&box compatibility
.result-view.victory .result-banner {
	border-color: rgba(74, 222, 128, 0.4);
	background-color: rgba(74, 222, 128, 0.1);
}

.result-view.victory .result-title {
	color: #4ade80;
	text-shadow: 0 0 30px rgba(74, 222, 128, 0.6), 0 0 60px rgba(74, 222, 128, 0.3);
}

// Defeat state - explicit selectors for S&box compatibility
.result-view.defeat .result-banner {
	border-color: rgba(239, 68, 68, 0.4);
	background-color: rgba(239, 68, 68, 0.1);
}

.result-view.defeat .result-title {
	color: #ef4444;
	text-shadow: 0 0 30px rgba(239, 68, 68, 0.6), 0 0 60px rgba(239, 68, 68, 0.3);
}

.result-rewards {
	display: flex;
	flex-direction: column;
	gap: 12px;
	padding: 24px 40px;
	background-color: rgba(0, 0, 0, 0.5);
	border-radius: 16px;
	border: 1px solid rgba(255, 255, 255, 0.1);
	min-width: 280px;
}

.reward-row {
	display: flex;
	justify-content: space-between;
	align-items: center;
	gap: 32px;
	animation: rewardSlideIn 0.15s ease-out;
}

.reward-label {
	font-size: 14px;
	font-weight: 500;
	color: rgba(255, 255, 255, 0.6);
	text-transform: uppercase;
	letter-spacing: 1px;
}

.reward-amount {
	font-size: 24px;
	font-weight: 800;
	color: #ffffff;
}

.reward-amount.gold {
	color: #fbbf24;
	text-shadow: 0 0 10px rgba(251, 191, 36, 0.3);
}

.reward-amount.xp {
	color: #a78bfa;
	text-shadow: 0 0 10px rgba(167, 139, 250, 0.3);
}

.wave-indicator {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 10px;
	color: rgba(255, 255, 255, 0.7);
	font-size: 14px;
	font-weight: 500;
	padding: 16px 24px;
	background-color: rgba(0, 0, 0, 0.3);
	border-radius: 12px;
	border: 1px solid rgba(255, 255, 255, 0.1);
}

.wave-progress-bar {
	width: 200px;
	height: 6px;
	background-color: rgba(255, 255, 255, 0.1);
	border-radius: 3px;
	overflow: hidden;
}

.wave-progress-fill {
	height: 100%;
	background-image: linear-gradient(90deg, #8b5cf6, #a78bfa);
	border-radius: 3px;
	transition: width 0.2s ease;
}

.expedition-complete-banner {
	display: flex;
	align-items: center;
	gap: 16px;
	padding: 16px 28px;
	background-image: linear-gradient(135deg, rgba(74, 222, 128, 0.2), rgba(74, 222, 128, 0.05));
	border: 2px solid rgba(74, 222, 128, 0.4);
	border-radius: 14px;
}

.complete-icon {
	font-size: 32px;
}

.complete-text {
	font-size: 20px;
	font-weight: 700;
	color: #4ade80;
	letter-spacing: 1px;
}

.defeat-info {
	font-size: 16px;
	color: rgba(255, 255, 255, 0.7);
	padding: 16px 24px;
	background-color: rgba(239, 68, 68, 0.15);
	border-radius: 12px;
	border: 1px solid rgba(239, 68, 68, 0.3);
}

// Action bar inside result view - no border, cleaner look
.result-view .action-bar {
	border-top: 0px;
	background-color: transparent;
	padding: 8px 0;
}

// ============================================
// RUNNING EXPEDITION BAR
// ============================================
.running-expedition-bar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 16px 24px;
	background-image: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(139, 92, 246, 0.05));
	border: 1px solid rgba(139, 92, 246, 0.3);
	border-radius: 16px;
	flex-shrink: 0;
}

.running-info {
	display: flex;
	align-items: center;
	gap: 12px;

	.running-icon {
		font-size: 24px;
	}

	.running-text {
		font-size: 16px;
		font-weight: 600;
		color: rgba(255, 255, 255, 0.9);
	}
}

.running-actions {
	display: flex;
	gap: 12px;
}

.btn-danger {
	padding: 12px 24px;
	font-size: 14px;
	font-weight: 700;
	letter-spacing: 1px;
	border-radius: 10px;
	cursor: pointer;
	transition: all 0.2s ease;
	pointer-events: all;
	border: 2px solid transparent;
	background-image: linear-gradient(135deg, #ef4444, #dc2626);
	border-color: #f87171;
	color: #ffffff;

	&:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 24px rgba(239, 68, 68, 0.3);
		background-image: linear-gradient(135deg, #f87171, #ef4444);
	}

	&:active {
		transform: translateY(0);
	}
}

// ============================================
// MONSTERS INFO BUTTON & POPUP
// ============================================
.monsters-info-btn {
	display: flex;
	align-items: center;
	gap: 6px;
	padding: 5px 12px;
	background-color: rgba(20, 15, 35, 0.95);
	border: 1px solid rgba(139, 92, 246, 0.4);
	border-radius: 6px;
	cursor: pointer;
	transition: all 0.2s ease;
	pointer-events: all;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);

	&:hover {
		background-color: rgba(139, 92, 246, 0.35);
		border-color: rgba(139, 92, 246, 0.7);
		transform: translateY(-1px);
		box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
	}

	.monsters-icon {
		font-size: 12px;
	}

	.monsters-label {
		font-size: 12px;
		font-weight: 700;
		color: #ffffff;
		letter-spacing: 0.3px;
		text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
	}
}

// Monsters popup overlay - nested for higher specificity
.expedition-panel .monsters-popup-overlay {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	width: 100%;
	height: 100%;
	background-color: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 500;
	pointer-events: all;
}

// Monsters popup - nested for higher specificity
.expedition-panel .monsters-popup-overlay .monsters-popup {
	width: 700px;
	height: 80vh;
	max-height: 800px;
	min-height: 400px;
	background-color: rgba(15, 15, 26, 0.98);
	border: 1px solid rgba(255, 255, 255, 0.15);
	border-radius: 16px;
	overflow: hidden;
	display: flex;
	flex-direction: column;
	box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
	flex-shrink: 0;
}

.popup-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 16px 20px;
	background-color: rgba(0, 0, 0, 0.4);
	border-bottom: 1px solid rgba(255, 255, 255, 0.1);
	flex-shrink: 0;
}

.popup-title {
	font-size: 16px;
	font-weight: 700;
	color: #ffffff;
}

.popup-close {
	width: 32px;
	height: 32px;
	background-color: rgba(255, 255, 255, 0.1);
	border: none;
	border-radius: 8px;
	font-size: 20px;
	color: rgba(255, 255, 255, 0.6);
	cursor: pointer;
	transition: all 0.2s ease;
	display: flex;
	align-items: center;
	justify-content: center;

	&:hover {
		background-color: rgba(239, 68, 68, 0.3);
		color: #ef4444;
	}
}

.popup-content {
	flex: 1;
	min-width: 0;
	min-height: 0;
	display: flex;
	flex-direction: column;
	gap: 24px;
	padding: 24px;
	padding-bottom: 40px;
	overflow-y: scroll;
	overflow-x: hidden;
	pointer-events: all;
}

.monsters-grid {
	display: flex;
	flex-wrap: wrap;
	gap: 16px;
	justify-content: flex-start;
}

// Scoped to monsters-grid to avoid overriding BattleView's .monster-card
.monsters-grid .monster-card {
	width: 140px;
	min-width: 140px;
	flex-shrink: 0;
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 12px;
	padding: 16px;
	background-color: rgba(0, 0, 0, 0.3);
	border: 2px solid rgba(255, 255, 255, 0.08);
	border-radius: 16px;
	transition: all 0.2s ease;

	&.discovered {
		border-color: rgba(74, 222, 128, 0.4);
		background-color: rgba(74, 222, 128, 0.08);
	}

	&.seen {
		border-color: rgba(139, 92, 246, 0.4);
		background-color: rgba(139, 92, 246, 0.08);
	}

	&.unknown {
		opacity: 0.5;
	}

	&:hover {
		transform: translateY(-4px);
		border-color: rgba(255, 255, 255, 0.2);
	}
}

// Scoped to monsters-grid to avoid overriding BattleView styles
.monsters-grid .monster-sprite-container {
	position: relative;
	width: 100px;
	height: 100px;
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: rgba(0, 0, 0, 0.4);
	border-radius: 12px;
}

.monsters-grid .monster-sprite {
	width: 88px;
	height: 88px;
	image-rendering: pixelated;
}

.monsters-grid .monster-sprite-unknown {
	font-size: 48px;
	font-weight: 800;
	color: rgba(255, 255, 255, 0.2);
}

.monsters-grid .monster-status-badge {
	position: absolute;
	top: -8px;
	right: -8px;
	width: 28px;
	height: 28px;
	display: flex;
	align-items: center;
	justify-content: center;
	border-radius: 50%;
	font-size: 14px;

	&.discovered {
		background-image: linear-gradient(135deg, #22c55e, #16a34a);
		color: #ffffff;
	}

	&.seen {
		background-image: linear-gradient(135deg, #8b5cf6, #6d28d9);
		color: #ffffff;
	}

	&.unknown {
		background-color: rgba(255, 255, 255, 0.15);
		color: rgba(255, 255, 255, 0.4);
	}
}

.monsters-grid .monster-details {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 4px;
	text-align: center;
}

.monsters-grid .monster-name {
	font-size: 14px;
	font-weight: 700;
	color: #ffffff;

	&.unknown {
		color: rgba(255, 255, 255, 0.4);
		font-style: italic;
	}
}

.monsters-grid .monster-element {
	font-size: 12px;
	color: rgba(255, 255, 255, 0.5);

	&.unknown {
		color: rgba(255, 255, 255, 0.3);
	}

	// Element colors
	&.fire { color: #ef4444; }
	&.water { color: #3b82f6; }
	&.earth { color: #a16207; }
	&.wind { color: #22c55e; }
	&.electric { color: #facc15; }
	&.ice { color: #7dd3fc; }
	&.nature { color: #4ade80; }
	&.metal { color: #94a3b8; }
	&.shadow { color: #a78bfa; }
	&.spirit { color: #ec4899; }
}

.monsters-grid .monster-rarity {
	font-size: 10px;
	font-weight: 700;
	padding: 2px 8px;
	border-radius: 4px;
	text-transform: uppercase;
	letter-spacing: 0.5px;

	&.common {
		background-color: rgba(156, 163, 175, 0.2);
		color: #9ca3af;
	}

	&.uncommon {
		background-color: rgba(34, 197, 94, 0.2);
		color: #22c55e;
	}

	&.rare {
		background-color: rgba(59, 130, 246, 0.2);
		color: #3b82f6;
	}

	&.epic {
		background-color: rgba(168, 85, 247, 0.2);
		color: #a855f7;
	}

	&.legendary {
		background-color: rgba(251, 191, 36, 0.2);
		color: #fbbf24;
	}

	&.mythic {
		background-color: rgba(251, 191, 36, 0.2);
		color: #fcd34d;
		text-shadow: 0 0 10px rgba(251, 191, 36, 0.6);
	}

	&.unknown {
		background-color: rgba(255, 255, 255, 0.1);
		color: rgba(255, 255, 255, 0.3);
	}
}

// ============================================
// POPUP SECTIONS (Regular / Boss)
// ============================================

.popup-section {
	width: 100%;
	display: flex;
	flex-direction: column;
	gap: 16px;
	flex-shrink: 0;
}

.section-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 12px 16px;
	background-color: rgba(0, 0, 0, 0.4);
	border-radius: 10px;
	border-left: 4px solid rgba(255, 255, 255, 0.3);

	&.boss {
		border-left-color: #fbbf24;
		background-color: rgba(251, 191, 36, 0.1);
	}
}

.section-title {
	font-size: 14px;
	font-weight: 700;
	color: rgba(255, 255, 255, 0.9);
	text-transform: uppercase;
	letter-spacing: 1px;

	.boss & {
		color: #fbbf24;
	}
}

.section-count {
	font-size: 12px;
	color: rgba(255, 255, 255, 0.5);
}

// Boss card styling (scoped to monsters-grid)
.monsters-grid .monster-card.boss-card {
	border-color: rgba(251, 191, 36, 0.4);
	background-color: rgba(251, 191, 36, 0.08);

	&.discovered {
		border-color: rgba(251, 191, 36, 0.6);
		background-color: rgba(251, 191, 36, 0.12);
	}

	&.seen {
		border-color: rgba(251, 191, 36, 0.5);
		background-color: rgba(251, 191, 36, 0.1);
	}

	&:hover {
		border-color: #fbbf24;
	}
}

.boss-badge {
	position: absolute;
	bottom: -6px;
	left: 50%;
	transform: translateX(-50%);
	padding: 2px 8px;
	background-image: linear-gradient(135deg, #fbbf24, #f59e0b);
	border-radius: 4px;
	font-size: 9px;
	font-weight: 800;
	color: #000000;
	text-transform: uppercase;
	letter-spacing: 1px;
}

// ============================================
// CARD INFO BUTTONS (Beasts + Drops)
// ============================================
.card-info-buttons {
	display: flex;
	gap: 8px;
	margin-top: 6px;
	position: relative;
	z-index: 3;
}

.drops-btn {
	background-color: rgba(25, 20, 10, 0.95);
	border: 1px solid rgba(251, 191, 36, 0.5);

	.monsters-label {
		color: #fcd34d;
	}

	&:hover {
		background-color: rgba(251, 191, 36, 0.3);
		border-color: rgba(251, 191, 36, 0.8);
	}
}

// ============================================
// DROPS POPUP
// ============================================
.drops-popup-overlay {
	z-index: 500;
}

// Higher specificity to override .monsters-popup width
.expedition-panel .monsters-popup-overlay .drops-popup {
	width: 800px;
	height: 80vh;
	min-height: 600px;
	max-height: 90vh;
}

// Section header variants
.section-header {
	&.held {
		border-left-color: #8b5cf6;
		background-color: rgba(139, 92, 246, 0.1);
	}

	&.consumable {
		border-left-color: #22c55e;
		background-color: rgba(34, 197, 94, 0.1);
	}

	&.relic {
		border-left-color: #f59e0b;
		background-color: rgba(245, 158, 11, 0.1);
	}
}

// Items grid
.items-grid {
	display: flex;
	flex-wrap: wrap;
	gap: 12px;
	justify-content: center;
}

// Item card
.item-card {
	width: 210px;
	min-width: 210px;
	flex-shrink: 0;
	display: flex;
	gap: 10px;
	padding: 12px;
	background-color: rgba(0, 0, 0, 0.3);
	border: 2px solid rgba(255, 255, 255, 0.08);
	border-radius: 12px;
	transition: all 0.2s ease;

	&:hover {
		transform: translateY(-2px);
		border-color: rgba(255, 255, 255, 0.2);
	}

	// Rarity colors
	&.common {
		border-color: rgba(156, 163, 175, 0.3);
		&:hover { border-color: rgba(156, 163, 175, 0.6); }
	}

	&.uncommon {
		border-color: rgba(34, 197, 94, 0.3);
		&:hover { border-color: rgba(34, 197, 94, 0.6); }
	}

	&.rare {
		border-color: rgba(59, 130, 246, 0.3);
		&:hover { border-color: rgba(59, 130, 246, 0.6); }
	}

	&.epic {
		border-color: rgba(168, 85, 247, 0.3);
		&:hover { border-color: rgba(168, 85, 247, 0.6); }
	}

	&.legendary {
		border-color: rgba(251, 191, 36, 0.3);
		&:hover { border-color: rgba(251, 191, 36, 0.6); }
	}

	&.mythic {
		border-color: rgba(236, 72, 153, 0.3);
		&:hover { border-color: rgba(236, 72, 153, 0.6); }
	}
}

.item-icon-container {
	width: 40px;
	height: 40px;
	min-width: 40px;
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: rgba(0, 0, 0, 0.4);
	border-radius: 8px;
}

.item-icon {
	width: 32px;
	height: 32px;
	image-rendering: pixelated;
}

.item-details {
	flex: 1;
	display: flex;
	flex-direction: column;
	gap: 2px;
	min-width: 0;
	overflow: hidden;
}

.item-name {
	font-size: 13px;
	font-weight: 700;
	color: #ffffff;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

.item-rarity {
	font-size: 10px;
	font-weight: 700;
	text-transform: uppercase;
	letter-spacing: 0.5px;

	&.common { color: #9ca3af; }
	&.uncommon { color: #22c55e; }
	&.rare { color: #3b82f6; }
	&.epic { color: #a855f7; }
	&.legendary { color: #fbbf24; }
	&.mythic { color: #ec4899; }
}

.item-desc {
	font-size: 10px;
	color: rgba(255, 255, 255, 0.5);
	line-height: 13px;
	overflow: hidden;
	text-overflow: clip;
	max-height: 150px;
}

// No drops message
.no-drops {
	width: 100%;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	gap: 8px;
	padding: 40px;
	color: rgba(255, 255, 255, 0.4);

	.empty-icon {
		font-size: 48px;
		opacity: 0.3;
	}

	.empty-text {
		font-size: 16px;
		font-weight: 600;
	}

	.empty-hint {
		font-size: 13px;
		opacity: 0.6;
	}
}
