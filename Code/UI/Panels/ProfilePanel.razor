@namespace Beastborne.UI.Panels
@using Sandbox;
@using Sandbox.UI;
@using Beastborne.Core;
@using Beastborne.Data;
@using Beastborne.Systems;
@using System.Linq;
@inherits Panel

<root class="@(IsVisible ? "visible" : "")">
	<div class="profile-overlay" onclick=@Close></div>

	<div class="profile-modal @GetRankClass()">
		<div class="profile-pattern"></div>
		<button class="close-btn" onclick=@Close>√ó</button>

		<!-- Zone 1: Hero Banner -->
		<div class="profile-hero">
			@{
				var heroBg = GetHeroBackground();
			}
			<div class="hero-bg" style="background-image: url('@heroBg')"></div>
			<div class="hero-overlay"></div>
			<div class="hero-content">
				<div class="avatar-frame" style="background: linear-gradient(135deg, @GetRankColor(), @GetRankColorDark())">
					<div class="avatar-portrait" style="background-image: url('@GetPortraitPath()')"></div>
				</div>
				<div class="level-block">
					<span class="level-label">LEVEL</span>
					<span class="level-number" style="color: @GetRankColor()">@GetLevel()</span>
					<div class="xp-bar">
						<div class="xp-fill" style="width: @(GetXPProgress() * 100)%"></div>
					</div>
					<span class="xp-text">@FormatLargeNumber( GetCurrentLevelXP() ) / @FormatLargeNumber( GetXPForNextLevel() ) XP</span>
				</div>
				<div class="hero-info">
					<span class="tamer-name">@GetTamerName()</span>
					<div class="title-row">
						<span class="title-text" style="color: @GetDisplayTitleColor()">@GetDisplayTitle()</span>
						<span class="title-edit-btn" style="border-color: rgba(139, 92, 246, 0.35); color: rgba(167, 139, 250, 0.8)" onclick=@ToggleTitleSelector>Change</span>
					</div>
					<span class="rank-pill" style="border-color: @GetRankColor(); color: @GetRankColor()">@GetRankIcon() @GetRankComputed()</span>
				</div>
			</div>
		</div>

		<div class="profile-content">
			<!-- Zone 2: Arena Showcase -->
			<div class="arena-showcase" style="border-left: 3px solid @GetRankColor()">
				<div class="arena-top-row">
					<div class="arena-rank-display">
						<div class="rank-icon-circle" style="border-color: @GetRankColor(); color: @GetRankColor(); box-shadow: 0 0 12px @(GetRankColor())33">
							<span class="rank-icon-text">@GetRankIcon()</span>
						</div>
						<div class="rank-details">
							<span class="rank-name" style="color: @GetRankColor()">@GetRankComputed()</span>
							<span class="rank-points">@GetArenaPoints().ToString("N0") pts</span>
						</div>
					</div>
					<div class="arena-winrate-badge" style="color: @GetRankColor()">
						<span class="arena-winrate-value">@GetArenaWinRate()%</span>
						<span class="arena-winrate-label">Win Rate</span>
					</div>
				</div>
				<div class="arena-stats-row">
					<div class="arena-stat-pill wins">
						<span class="arena-stat-value">@GetArenaWins().ToString("N0")</span>
						<span class="arena-stat-label">Wins</span>
					</div>
					<div class="arena-stat-pill losses">
						<span class="arena-stat-value">@GetArenaLosses().ToString("N0")</span>
						<span class="arena-stat-label">Losses</span>
					</div>
					@if ( GetArenaWinStreak() > 0 )
					{
						<div class="arena-stat-pill streak">
							<span class="arena-stat-value">@GetArenaWinStreak().ToString("N0")</span>
							<span class="arena-stat-label">Streak</span>
						</div>
					}
				</div>
			</div>

			<!-- Zone 3: Resources Row -->
			<div class="resources-row">
				<div class="resource-pill">
					<span class="resource-icon-text">ü™ô</span>
					<span class="resource-value gold">@GetGold().ToString("N0")</span>
				</div>
				<div class="resource-pill">
					<span class="resource-icon-text">üíé</span>
					<span class="resource-value gems">@GetGems().ToString("N0")</span>
				</div>
				<div class="resource-pill">
					<span class="resource-icon-text">üñã</span>
					<span class="resource-value ink">@GetContractInk().ToString("N0")</span>
				</div>
				@if ( GetBossTokens() > 0 )
				{
					<div class="resource-pill">
						<span class="resource-icon-text">üèÜ</span>
						<span class="resource-value tokens">@GetBossTokens().ToString("N0")</span>
					</div>
				}
			</div>

			<!-- Zone 4: Stats Grid -->
			<div class="stats-grid">
				<div class="stats-row">
					<div class="stat-card">
						<span class="stat-card-value">@GetMonstersCaught().ToString("N0")</span>
						<span class="stat-card-label">CAUGHT</span>
					</div>
					<div class="stat-card">
						<span class="stat-card-value">@GetMonstersBred().ToString("N0")</span>
						<span class="stat-card-label">BRED</span>
					</div>
					<div class="stat-card">
						<span class="stat-card-value">@GetMonstersEvolved().ToString("N0")</span>
						<span class="stat-card-label">EVOLVED</span>
					</div>
				</div>
				<div class="stats-row">
					<div class="stat-card">
						<span class="stat-card-value">@GetBattlesWon().ToString("N0")</span>
						<span class="stat-card-label">BATTLES WON</span>
					</div>
					<div class="stat-card">
						<span class="stat-card-value">@FormatLargeNumber( GetTotalDamageDealt() )</span>
						<span class="stat-card-label">DAMAGE</span>
					</div>
					<div class="stat-card">
						<span class="stat-card-value">@GetTotalKnockouts().ToString("N0")</span>
						<span class="stat-card-label">KNOCKOUTS</span>
					</div>
				</div>
			</div>

			<!-- Zone 5: Favorites & Collection -->
			<div class="collection-section">
				<div class="favorite-beast @(GetFavoriteMonsterSpecies()?.Element.ToString().ToLower() ?? "")">
					<span class="section-label">FAVORITE BEAST</span>
					@if ( showBeastSelector )
					{
						<div class="fav-selector-dropdown">
							<div class="fav-opt" onclick=@(() => SetFavoriteBeast( null ))>
								<span class="fav-opt-name">None</span>
							</div>
							@foreach ( var species in GetDiscoveredSpeciesList() )
							{
								<div class="fav-opt" onclick=@(() => SetFavoriteBeast( species.Id ))>
									@if ( !string.IsNullOrEmpty( species.IconPath ) )
									{
										<img class="fav-opt-icon" src="@species.IconPath" />
									}
									<span class="fav-opt-name">@species.Name</span>
								</div>
							}
						</div>
					}
					else
					{
						<div class="fav-display beast-display" onclick=@(() => { showBeastSelector = true; showExpeditionSelector = false; })>
							@{
								var favSpecies = GetFavoriteMonsterSpecies();
							}
							@if ( favSpecies != null && !string.IsNullOrEmpty( favSpecies.IconPath ) )
							{
								<div class="beast-portrait-frame">
									<img class="beast-portrait-img" src="@favSpecies.IconPath" style="margin-left: @(favSpecies.IconOffsetX - 18)px; margin-top: @(favSpecies.IconOffsetY)px" />
								</div>
								<span class="fav-name">@favSpecies.Name</span>
							}
							else
							{
								<span class="fav-empty">Select...</span>
							}
							<span class="fav-change-hint">Change</span>
						</div>
					}
				</div>
				<div class="favorite-expedition">
					@{
						var expBg = GetFavoriteExpeditionBackground();
					}
					@if ( expBg != null )
					{
						<div class="exp-box-bg" style="background-image: url(@expBg)"></div>
					}
					<span class="section-label">FAVORITE EXPEDITION</span>
					@if ( showExpeditionSelector )
					{
						<div class="fav-selector-dropdown">
							<div class="fav-opt" onclick=@(() => SetFavoriteExpedition( null ))>
								<span class="fav-opt-name">None</span>
							</div>
							@foreach ( var exp in GetClearedExpeditions() )
							{
								<div class="fav-opt exp-opt" onclick=@(() => SetFavoriteExpedition( exp.Id ))>
									<div class="exp-opt-bg" style="background-image: url('@exp.BackgroundImage')"></div>
									<span class="fav-opt-name">@exp.Name</span>
								</div>
							}
						</div>
					}
					else
					{
						<div class="fav-display exp-display" onclick=@(() => { showExpeditionSelector = true; showBeastSelector = false; })>
							<span class="fav-name">@GetFavoriteExpeditionName()</span>
							<span class="fav-change-hint">Change</span>
						</div>
					}
				</div>
			</div>

			<!-- Collection Stats -->
			<div class="collection-bar-section">
				<div class="collection-row">
					<span class="collection-value">@GetOwnedMonsters()/@GetMaxMonsters()</span>
					<span class="collection-detail">Owned</span>
					<span class="collection-sep">¬∑</span>
					<span class="collection-value">@GetDiscoveredSpecies()/@GetTotalSpecies()</span>
					<span class="collection-detail">Discovered</span>
				</div>
				<div class="discovery-bar">
					<div class="discovery-fill" style="width: @(GetDiscoveryPercent())%"></div>
				</div>
			</div>

			<!-- Zone 6: Progression -->
			<div class="progression-section">
				<span class="section-label">PROGRESSION</span>
				<div class="progression-pills">
					<div class="prog-pill expedition">
						<span class="prog-value">Stage @GetHighestExpedition().ToString("N0")</span>
						<span class="prog-label">Highest</span>
					</div>
					<div class="prog-pill skills">
						<span class="prog-value">@GetSkillRanksInvested().ToString("N0")/@GetMaxSkillRanks().ToString("N0")</span>
						<span class="prog-label">Skills</span>
					</div>
					<div class="prog-pill achievements">
						<span class="prog-value">@GetAchievementCount().ToString("N0")</span>
						<span class="prog-label">Achievements</span>
					</div>
					<div class="prog-pill expeditions">
						<span class="prog-value">@GetTotalExpeditions().ToString("N0")</span>
						<span class="prog-label">Expeditions</span>
					</div>
					<div class="prog-pill trades">
						<span class="prog-value">@GetTotalTrades().ToString("N0")</span>
						<span class="prog-label">Trades</span>
					</div>
				</div>
			</div>

			<!-- Zone 7: Actions -->
			<div class="profile-actions">
				<button class="action-btn card-btn" onclick=@OnViewCardCollection>
					<span class="action-icon">&#127183;</span>
					<span class="action-label">Tamer Cards</span>
					<span class="action-count">@GetCollectedCardCount()</span>
				</button>
				<button class="action-btn achievement-btn" onclick=@OnViewAchievements>
					<span class="action-icon">üèÖ</span>
					<span class="action-label">Achievements</span>
					<span class="action-count">@GetAchievementCount()/@GetTotalAchievementCount()</span>
				</button>
			</div>

			<!-- Zone 8: Footer -->
			<div class="profile-footer">
				<span class="playtime">Playtime: @GetPlayTime()</span>
				<span class="created-date">Tamer since @GetCreatedDate()</span>
			</div>
		</div>

		<!-- Title Selector Popup Overlay -->
		@if ( showTitleSelector )
		{
			<div class="title-overlay" onclick=@CloseTitleSelector></div>
			<div class="title-popup">
				<span class="title-popup-header">SELECT TITLE</span>
				<div class="title-popup-list">
					@foreach ( var lt in GetEarnedLevelTitles() )
					{
						<button class="title-option @(string.IsNullOrEmpty( GetTamer()?.ActiveTitleId ) && GetDisplayTitle() == lt ? "active" : "")"
							onclick=@(() => SelectLevelTitle( lt ))>
							<span class="title-option-name" style="color: #a78bfa">@lt</span>
						</button>
					}
					@if ( GetUnlockedTitles().Count > 0 )
					{
						<span class="title-section-divider">COSMETIC</span>
					}
					@foreach ( var title in GetUnlockedTitles() )
					{
						<button class="title-option @(GetTamer()?.ActiveTitleId == title.Id ? "active" : "")"
							onclick=@(() => SelectTitle( title.Id ))>
							<span class="title-option-name" style="color: @title.TitleColor">@title.Title</span>
						</button>
					}
				</div>
			</div>
		}
	</div>
</root>

@code {
	public static bool IsVisible { get; set; } = false;

	public static void Show() => IsVisible = true;
	public static void Close() => IsVisible = false;
	public static void Toggle() => IsVisible = !IsVisible;

	private bool showTitleSelector = false;
	private bool showBeastSelector = false;
	private bool showExpeditionSelector = false;

	private Tamer GetTamer() => TamerManager.Instance?.CurrentTamer;

	// Identity
	private string GetTamerName() => GetTamer()?.Name ?? "Unknown Tamer";
	private int GetLevel() => GetTamer()?.Level ?? 1;
	private float GetXPProgress() => GetTamer()?.XPProgress ?? 0;
	private int GetCurrentLevelXP() => GetTamer()?.CurrentLevelXP ?? 0;
	private int GetXPForNextLevel() => GetTamer()?.XPForNextLevel ?? 100;

	// Resources
	private int GetGold() => GetTamer()?.Gold ?? 0;
	private int GetGems() => GetTamer()?.Gems ?? 0;
	private int GetContractInk() => GetTamer()?.ContractInk ?? 0;
	private int GetBossTokens() => GetTamer()?.BossTokens ?? 0;

	// Battle stats
	private int GetBattlesWon() => GetTamer()?.TotalBattlesWon ?? 0;
	private int GetBattlesLost() => GetTamer()?.TotalBattlesLost ?? 0;

	// Arena
	private string GetArenaRank() => GetTamer()?.ArenaRank ?? "Unranked";
	private int GetArenaPoints() => GetTamer()?.ArenaPoints ?? 0;
	private int GetArenaWins() => GetTamer()?.ArenaWins ?? 0;
	private int GetArenaLosses() => GetTamer()?.ArenaLosses ?? 0;
	private int GetArenaWinRate()
	{
		var total = GetArenaWins() + GetArenaLosses();
		return total > 0 ? (int)((float)GetArenaWins() / total * 100) : 0;
	}
	private int GetArenaWinStreak() => GetTamer()?.ArenaWinStreak ?? 0;

	// Rank helpers
	private string GetRankComputed() => CompetitiveManager.GetRankFromPoints( GetArenaPoints() );
	private string GetRankColor()
	{
		var color = CompetitiveManager.GetRankColor( GetRankComputed() );
		// Brighten unranked so it's visible on dark backgrounds
		if ( color == "#6b7280" ) return "#9ca3af";
		return color;
	}
	private string GetRankIcon() => CompetitiveManager.GetRankIcon( GetRankComputed() );
	private string GetRankClass() => $"rank-{GetRankComputed().ToLower()}";
	private string GetRankColorDark()
	{
		// Darken the rank color for gradient end
		return GetRankComputed() switch
		{
			"Mythic" => "#9d174d",
			"Legendary" => "#92400e",
			"Master" => "#581c87",
			"Diamond" => "#1e40af",
			"Platinum" => "#155e75",
			"Gold" => "#713f12",
			"Silver" => "#374151",
			"Bronze" => "#78350f",
			_ => "#374151"
		};
	}

	// Monsters
	private int GetMonstersCaught() => GetTamer()?.TotalMonstersCaught ?? 0;
	private int GetMonstersBred() => GetTamer()?.TotalMonstersBred ?? 0;
	private int GetMonstersEvolved() => GetTamer()?.TotalMonstersEvolved ?? 0;
	private int GetOwnedMonsters() => MonsterManager.Instance?.OwnedMonsters?.Count ?? 0;
	private int GetMaxMonsters() => MonsterManager.Instance?.MaxMonsters ?? 50;

	// Discovery
	private int GetDiscoveredSpecies() => BeastiaryManager.Instance?.GetDiscoveryCount() ?? 0;
	private int GetTotalSpecies() => BeastiaryManager.Instance?.GetTotalSpeciesCount() ?? 1;
	private int GetDiscoveryPercent()
	{
		var total = GetTotalSpecies();
		return total > 0 ? (int)((float)GetDiscoveredSpecies() / total * 100) : 0;
	}

	// Progression
	private int GetHighestExpedition() => GetTamer()?.HighestExpeditionCleared ?? 0;
	private int GetSkillRanksInvested() => GetTamer()?.SkillRanks?.Values.Sum() ?? 0;
	private int GetMaxSkillRanks() => TamerManager.Instance?.GetMaxPossibleRanks() ?? 0;
	private int GetTotalExpeditions() => GetTamer()?.TotalExpeditionsCompleted ?? 0;
	private int GetTotalTrades() => GetTamer()?.TotalTradesCompleted ?? 0;
	private int GetTotalDamageDealt() => GetTamer()?.TotalDamageDealt ?? 0;
	private int GetTotalKnockouts() => GetTamer()?.TotalKnockouts ?? 0;

	// Achievements
	private int GetAchievementCount() => GetTamer()?.Achievements?.Values.Count( p => p.IsUnlocked ) ?? 0;
	private int GetTotalAchievementCount() => AchievementManager.Instance?.GetTotalCount() ?? 0;

	// Favorite monster
	private MonsterSpecies GetFavoriteMonsterSpecies()
	{
		var id = GetTamer()?.FavoriteMonsterSpeciesId;
		if ( string.IsNullOrEmpty( id ) ) return null;
		return MonsterManager.Instance?.GetSpecies( id );
	}

	private string GetFavoriteMonsterName()
	{
		var id = GetTamer()?.FavoriteMonsterSpeciesId;
		if ( string.IsNullOrEmpty( id ) ) return null;
		return MonsterManager.Instance?.GetSpecies( id )?.Name;
	}
	private string GetFavoriteMonsterIcon()
	{
		var id = GetTamer()?.FavoriteMonsterSpeciesId;
		if ( string.IsNullOrEmpty( id ) ) return null;
		return MonsterManager.Instance?.GetSpecies( id )?.IconPath;
	}

	// Favorite beast selector
	private List<MonsterSpecies> GetDiscoveredSpeciesList()
	{
		var discovered = BeastiaryManager.Instance?.DiscoveredSpecies;
		if ( discovered == null || discovered.Count == 0 ) return new();
		return discovered
			.Select( id => MonsterManager.Instance?.GetSpecies( id ) )
			.Where( s => s != null )
			.OrderBy( s => s.Name )
			.ToList();
	}

	private void SetFavoriteBeast( string speciesId )
	{
		var tamer = GetTamer();
		if ( tamer != null )
		{
			tamer.FavoriteMonsterSpeciesId = speciesId;
			TamerManager.Instance?.SaveToCloud();
		}
		showBeastSelector = false;
	}

	// Favorite expedition
	private string GetFavoriteExpeditionBackground()
	{
		var expId = GetTamer()?.FavoriteExpeditionId;
		if ( string.IsNullOrEmpty( expId ) ) return null;
		return ExpeditionManager.Instance?.GetExpedition( expId )?.BackgroundImage;
	}

	private string GetFavoriteExpeditionName()
	{
		var expId = GetTamer()?.FavoriteExpeditionId;
		if ( string.IsNullOrEmpty( expId ) ) return "Select...";
		return ExpeditionManager.Instance?.GetExpedition( expId )?.Name ?? expId;
	}

	private List<Expedition> GetClearedExpeditions()
	{
		var highest = GetTamer()?.HighestExpeditionCleared ?? 0;
		return ExpeditionManager.Instance?.Expeditions?
			.Where( ( e, i ) => i < highest )
			.ToList() ?? new();
	}

	private void SetFavoriteExpedition( string expId )
	{
		var tamer = GetTamer();
		if ( tamer != null )
		{
			tamer.FavoriteExpeditionId = expId;
			TamerManager.Instance?.SaveToCloud();
			ChatManager.Instance?.SendPlayerProfile();
		}
		showExpeditionSelector = false;
	}

	// Portrait
	private string GetPortraitPath() => GetTamer()?.Gender == TamerGender.Female
		? "ui/characters/female/female_tamer.png"
		: "ui/characters/male/male_tamer.png";

	// Hero background - use favorite expedition if set, otherwise default
	private string GetHeroBackground()
	{
		var expId = GetTamer()?.FavoriteExpeditionId;
		if ( !string.IsNullOrEmpty( expId ) )
		{
			var bg = ExpeditionManager.Instance?.GetExpedition( expId )?.BackgroundImage;
			if ( !string.IsNullOrEmpty( bg ) ) return bg;
		}
		return "ui/menus/bg_tamercard.png";
	}

	// Title system
	private string GetTitle()
	{
		var level = GetLevel();
		if ( level >= 80 ) return "Legendary Tamer";
		if ( level >= 60 ) return "Master Tamer";
		if ( level >= 40 ) return "Expert Tamer";
		if ( level >= 20 ) return "Skilled Tamer";
		if ( level >= 10 ) return "Apprentice Tamer";
		return "Tamer";
	}

	private string GetDisplayTitle()
	{
		var tamer = GetTamer();
		var activeId = tamer?.ActiveTitleId;
		if ( !string.IsNullOrEmpty( activeId ) )
		{
			var title = CosmeticDatabase.GetTitle( activeId );
			if ( title != null ) return title.Title;
		}
		if ( !string.IsNullOrEmpty( tamer?.ActiveLevelTitle ) )
			return tamer.ActiveLevelTitle;
		return GetTitle();
	}

	private string GetDisplayTitleColor()
	{
		var activeId = GetTamer()?.ActiveTitleId;
		if ( !string.IsNullOrEmpty( activeId ) )
		{
			var title = CosmeticDatabase.GetTitle( activeId );
			if ( title != null ) return title.TitleColor;
		}
		return "#a78bfa";
	}

	private List<TamerTitle> GetUnlockedTitles()
	{
		var unlocked = GetTamer()?.UnlockedTitles;
		if ( unlocked == null || unlocked.Count == 0 ) return new();
		return CosmeticDatabase.Titles.Where( t => unlocked.Contains( t.Id ) ).ToList();
	}

	private void ToggleTitleSelector()
	{
		showTitleSelector = !showTitleSelector;
		SoundManager.PlayClick();
	}

	private void CloseTitleSelector()
	{
		showTitleSelector = false;
		SoundManager.PlayClick();
	}

	private void SelectTitle( string titleId )
	{
		TamerManager.Instance?.SetActiveTitle( titleId );
		var tamer = GetTamer();
		if ( tamer != null ) tamer.ActiveLevelTitle = null;
		TamerManager.Instance?.SaveToCloud();
		showTitleSelector = false;
		SoundManager.PlayClick();
		ChatManager.Instance?.SendPlayerProfile();
	}

	private List<string> GetEarnedLevelTitles()
	{
		var level = GetLevel();
		var titles = new List<string> { "Tamer" };
		if ( level >= 10 ) titles.Add( "Apprentice Tamer" );
		if ( level >= 20 ) titles.Add( "Skilled Tamer" );
		if ( level >= 40 ) titles.Add( "Expert Tamer" );
		if ( level >= 60 ) titles.Add( "Master Tamer" );
		if ( level >= 80 ) titles.Add( "Legendary Tamer" );
		return titles;
	}

	private void SelectLevelTitle( string title )
	{
		var tamer = GetTamer();
		if ( tamer == null ) return;
		tamer.ActiveTitleId = null;
		tamer.ActiveLevelTitle = title;
		TamerManager.Instance?.SaveToCloud();
		showTitleSelector = false;
		SoundManager.PlayClick();
		ChatManager.Instance?.SendPlayerProfile();
	}

	// Formatting
	private string FormatLargeNumber( int value )
	{
		if ( value >= 1000000 ) return $"{value / 1000000f:F1}M";
		if ( value >= 1000 ) return $"{value / 1000f:F1}K";
		return value.ToString( "N0" );
	}

	private string GetPlayTime()
	{
		var time = GetTamer()?.TotalPlayTime ?? TimeSpan.Zero;
		if ( time.TotalDays >= 1 )
			return $"{(int)time.TotalDays}d {time.Hours}h";
		if ( time.TotalHours >= 1 )
			return $"{(int)time.TotalHours}h {time.Minutes}m";
		return $"{time.Minutes}m";
	}

	private string GetCreatedDate()
	{
		var date = GetTamer()?.CreatedAt ?? DateTime.UtcNow;
		return date.ToString( "MMM d, yyyy" );
	}

	private int GetCollectedCardCount() => GetTamer()?.CollectedCards?.Count ?? 0;

	// Navigation
	private void OnViewCardCollection()
	{
		Close();
		CardCollectionPanel.Show();
	}

	private void OnViewAchievements()
	{
		Close();
		AchievementPanel.Show();
	}

	public override void Tick()
	{
		base.Tick();
		if ( IsVisible && Input.Pressed( "Escape" ) )
			Close();
	}

	protected override int BuildHash()
	{
		var hash = new HashCode();
		hash.Add( IsVisible );
		hash.Add( GetLevel() );
		hash.Add( GetGold() );
		hash.Add( GetGems() );
		hash.Add( GetBattlesWon() );
		hash.Add( GetArenaPoints() );
		hash.Add( GetOwnedMonsters() );
		hash.Add( GetAchievementCount() );
		hash.Add( GetTamer()?.ActiveTitleId );
		hash.Add( GetTamer()?.ActiveLevelTitle );
		hash.Add( GetTamer()?.FavoriteMonsterSpeciesId );
		hash.Add( GetTamer()?.FavoriteExpeditionId );
		hash.Add( showTitleSelector );
		hash.Add( showBeastSelector );
		hash.Add( showExpeditionSelector );
		return hash.ToHashCode();
	}
}
